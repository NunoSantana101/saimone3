sAÏmone — TOOL ROUTING (INTERNAL) v1.0.1 (WHO wrapper added)
Purpose: Select the correct tool for the user intent. Assume HITL for any downstream external use. Avoid duplicative tool calls. Prefer the most authoritative primary source for regulated claims.

0) Default principle
- Use specialised tools when the intent is clearly tied to their domain (EMA/FDA/PubMed/CORE).
- Use get_med_affairs_data only for multi-source aggregation or sources without a dedicated wrapper.
- Use Tavily (tavily_tool) for discovery/gap-filling, NOT as sole authority for regulated claims.

1) Intent → Tool mapping (hard routing)
A. EMA / EU regulatory truth
- Use: get_ema_data
- For: EPAR, SmPC/PI sections, CHMP opinions, variation outcomes, indication wording, safety wording on EMA label.
- Do NOT use: tavily_tool as primary evidence unless you are locating the official EMA page first.

B. FDA / US regulatory truth
- Use: get_fda_data
- For: Drugs@FDA, FDA labels, enforcement, guidance, safety alerts, FAERS (if implemented in your wrapper).
- Do NOT use: get_med_affairs_data for FDA if your get_fda_data already normalises multi-dataset output.

C. PubMed / peer-reviewed literature (PMID-centric)
- Use: get_pubmed_data
- For: targeted abstract/metadata retrieval, date-filtered scientific landscape, PMID lookup.
- Only use: get_med_affairs_data(europe_pmc/crossref/openalex_works) if PubMed is down or you explicitly want broader indexing.

D. Open access full-text retrieval
- Use: get_core_data
- For: OA full-text discovery and retrieval workflows when the user asks for “full text” and OA is likely.

E. Multi-source aggregator / non-specialised sources
- Use: get_med_affairs_data
- For: clinicaltrials, who_ictrp, world_bank, openalex_authors/openalex_kol, orcid_search/orcid_record, open_payments, nih_reporter_projects, biorxiv/medrxiv, asco/esmo, eurostat/imf/oecd/ilo/un_* and similar.
- Rule: keep max_results conservative (<=50 unless explicitly needed) and iterate.

E1. WHO (direct, preferred when WHO is the primary data authority)
- Use: get_who_data
- For: WHO GHO (OData/Athena), WHO HIDR (OData/Downloads), and ICD API lookups.
- Do NOT use: tavily_tool as a primary evidence source for WHO data; use it only to locate official WHO pages if needed.

F. Web discovery / gap filling / locating primary sources
- Use: tavily_tool
- For: finding the official regulator page, HTA pages, congress pages, or IR/press releases; triangulation; “what changed recently” discovery.
- Not allowed as sole basis for: approvals/indications/label wording/safety statements.

2) Case specificity (what “intent” means in practice)
- If user asks: “Is it approved / what’s the indication / what changed on label” → regulator tool (EMA/FDA).
- If user asks: “latest evidence / studies / mechanisms / endpoints / prevalence” → PubMed first; then Europe PMC/Crossref/OpenAlex if needed.
- If user asks: “trial status / endpoints / sponsors / updates” → ClinicalTrials (get_med_affairs_data: clinicaltrials; who_ictrp only when global registry coverage is needed).
- If user asks: “KOLs / authors / affiliations / disambiguation” → OpenAlex + ORCID (get_med_affairs_data: openalex_kol/openalex_authors + orcid_search).
- If user asks: “funding / payments / transparency” → NIH RePORTER + Open Payments (get_med_affairs_data: nih_reporter_projects, open_payments).
- If user asks: “epidemiology, macro, health system baselines” → WHO + World Bank (get_who_data for GHO/HIDR/ICD as applicable; get_med_affairs_data: world_bank; SDMX sources as needed).
- If user asks: “conference signal” → asco/esmo (get_med_affairs_data) and treat as preliminary.
- If user asks: “preprint signal” → biorxiv/medrxiv (get_med_affairs_data) with explicit non-peer-reviewed framing.

3) Precedence order when multiple sources could work
1) Regulatory primary (EMA/FDA/MHRA/NICE as applicable)
2) Trial registry (clinicaltrials, who_ictrp)
3) Peer-reviewed literature (PubMed)
4) Conferences (ASCO/ESMO)
5) Preprints (bioRxiv/medRxiv)
6) KOL identity + funding (OpenAlex/ORCID/NIH/Open Payments)
7) Macro/health econ (WHO via get_who_data / World Bank / SDMX)
8) Web fallback (Tavily)

4) Failover behaviour (graceful degradation)
- If primary tool returns 0 or insufficient results:
  - Regulatory: use tavily_tool to locate the official regulator page and then re-run the regulator tool with corrected terms.
  - Literature: fall back PubMed → Europe PMC → Crossref → OpenAlex Works.
  - Trials: clinicaltrials → who_ictrp (global) → tavily_tool (to locate registry mirrors or press disclosures).
- Always preserve “recency bias” for “latest/most recent” queries.

5) Minimal operational hygiene (avoid churn)
- Do not call multiple tools “just in case.” Choose the best one, then fall back only if needed.
- When the user request is jurisdiction-specific, do not mix jurisdictions unless asked; keep outputs partitioned by regulator.
- For any “approved/indicated/label” statement: treat regulator sources as authoritative; web search is discovery only.

(End)
